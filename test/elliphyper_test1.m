syms x y c gamma

% ellip
a1 = (sqrt((x+c)^2+y^2)+sqrt((x-c)^2+y^2))/2;
b1 = sqrt(a1^2-c^2);
% hyper
a2 = (sqrt((x+c)^2+y^2)-sqrt((x-c)^2+y^2))/2;
b2 = sqrt(c^2-a2^2);

% big ellip
alpha = sqrt((c^2+sqrt(c^4+4*a1^2*b1^2*gamma^2))/a1^2/2);
a3 = a1*alpha;
b3 = sqrt(a3^2-c^2);

x3 = sqrt((b3^2+b2^2)/(b3^2/a3^2+b2^2/a2^2));
y3 = sqrt((a3^2-a2^2)/(a3^2/b3^2+a2^2/b2^2));

J = det([diff(x3, x) diff(x3, y); diff(y3, x) diff(y3, y)]);

Jc = ilovedot(char(J));
Jc = regexprep(Jc, 'x', 'xx');
Jc = regexprep(Jc, 'y', 'yy');
Jc = regexprep(Jc, 'c', 'c0');
Jc = regexprep(Jc, 'gamma', 'gamma_1');

x3c = ilovedot(char(x3));
x3c = regexprep(x3c, 'x', 'xx');
x3c = regexprep(x3c, 'y', 'yy');
x3c = regexprep(x3c, 'c', 'c0');
x3c = regexprep(x3c, 'gamma', 'gamma_1');

y3c = ilovedot(char(y3));
y3c = regexprep(y3c, 'x', 'xx');
y3c = regexprep(y3c, 'y', 'yy');
y3c = regexprep(y3c, 'c', 'c0');
y3c = regexprep(y3c, 'gamma', 'gamma_1');

alpha_1 = 1.1;
gamma_1 = 1.1;
c0 = 1;
a0 = 1.1;
b0 = sqrt(a0^2-c0^2);
tt = linspace(eps, pi/2-eps, 100);
xx = a0.*cos(tt);
yy = b0.*sin(tt);

xx3 = eval(x3c);
yy3 = eval(y3c);
J3 = eval(Jc);


Jc2 = (2^(1/2)*(32*c^3*gamma^2*x*y^3 - 32*c^3*gamma^2*x^3*y + 16*c^5*gamma^2*x*y + ...
    ...
    4*gamma^2*y*(c^2 - 2*c*x + x^2 + y^2)^(1/2)* ...
    (c^2 + 2*c*x + x^2 + y^2)^(3/2)*(c^4 + 2*gamma^2*x^4 + 2*gamma^2*y^4 - 2*c^2*gamma^2*x^2 + 2*c^2*gamma^2*y^2 + ...
    4*gamma^2*x^2*y^2 + gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(3/2) + gamma^2*(c^2 - 2*c*x ...
    + x^2 + y^2)^(3/2)*(c^2 + 2*c*x + x^2 + y^2)^(1/2) - 2*c^2*gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*...
    (c^2 + 2*c*x + x^2 + y^2)^(1/2))^(1/2) ...
    ...
    - 4*gamma^2*y*(c^2 - 2*c*x + x^2 + y^2)^(3/2)*(c^2 + 2*c*x + x^2 + y^2)^(1/2)*...
    (c^4 + 2*gamma^2*x^4 + 2*gamma^2*y^4 - 2*c^2*gamma^2*x^2 + 2*c^2*gamma^2*y^2 + 4*gamma^2*x^2*y^2 + gamma^2*...
    (c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(3/2) + gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(3/2)...
    *(c^2 + 2*c*x + x^2 + y^2)^(1/2) - 2*c^2*gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(1/2))^(1/2) ...
    ...
    + 16*c*gamma^2*x*y^3*(c^4 + 2*gamma^2*x^4 + 2*gamma^2*y^4 - 2*c^2*gamma^2*x^2 + 2*c^2*gamma^2*y^2 + 4*gamma^2*x^2*y^2 ...
    + gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(3/2) + gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(3/2)*...
    (c^2 + 2*c*x + x^2 + y^2)^(1/2) - 2*c^2*gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(1/2))^(1/2) ...
    ...
    + 16*c*gamma^2*x^3*y*(c^4 + 2*gamma^2*x^4 + 2*gamma^2*y^4 - 2*c^2*gamma^2*x^2 + 2*c^2*gamma^2*y^2 + 4*gamma^2*x^2*y^2 ...
    + gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(3/2) + gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(3/2)*...
    (c^2 + 2*c*x + x^2 + y^2)^(1/2) - 2*c^2*gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(1/2))^(1/2))) ...
    /...
    (8*c*(( ...
    ((c^2 - 2*c*x + x^2 + y^2)^(1/2) - (c^2 + 2*c*x + x^2 + y^2)^(1/2))^2* ...
    ((c^4 + 2*gamma^2*x^4 + 2*gamma^2*y^4 - ...
    2*c^2*gamma^2*x^2 + 2*c^2*gamma^2*y^2 + 4*gamma^2*x^2*y^2 + gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*...
    (c^2 + 2*c*x + x^2 + y^2)^(3/2) + gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(3/2)*(c^2 + 2*c*x + x^2 + y^2)^(1/2) - ...
    2*c^2*gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(1/2))^(1/2) + c^2) ...
    )/c^2)^(1/2)* ...
    ...
    ((...
    ((c^4 + 2*gamma^2*x^4 + 2*gamma^2*y^4 - 2*c^2*gamma^2*x^2 + 2*c^2*gamma^2*y^2 + 4*gamma^2*x^2*y^2 + ...
    gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(3/2) + gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(3/2)*...
    (c^2 + 2*c*x + x^2 + y^2)^(1/2) - 2*c^2*gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(1/2))^(1/2) ...
    - c^2)*((c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(1/2) + c^2 - x^2 - y^2) ...
    )/c^2)^(1/2)*...
    (c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(1/2)*(c^4 + 2*gamma^2*x^4 + 2*gamma^2*y^4 - ...
    2*c^2*gamma^2*x^2 + 2*c^2*gamma^2*y^2 + 4*gamma^2*x^2*y^2 + gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*...
    (c^2 + 2*c*x + x^2 + y^2)^(3/2) + gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(3/2)*(c^2 + 2*c*x + x^2 + y^2)^(1/2) - ...
    2*c^2*gamma^2*(c^2 - 2*c*x + x^2 + y^2)^(1/2)*(c^2 + 2*c*x + x^2 + y^2)^(1/2))^(1/2));

